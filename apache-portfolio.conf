# Configuración de Apache VirtualHost para Portfolio
# Copiar este archivo a: C:\Apache24\conf\extra\ (o tu ruta de Apache en Windows)
# Luego incluir en httpd.conf: Include conf/extra/apache-portfolio.conf

# Habilitar módulos necesarios en httpd.conf:
# LoadModule proxy_module modules/mod_proxy.so
# LoadModule proxy_http_module modules/mod_proxy_http.so
# LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so
# LoadModule headers_module modules/mod_headers.so

# VirtualHost para puerto 80 (HTTP)
<VirtualHost *:80>
    ServerName 181.114.111.21
    ServerAlias localhost

    # Logs
    ErrorLog "logs/portfolio-error.log"
    CustomLog "logs/portfolio-access.log" combined

    # Proxy al frontend en WSL2
    ProxyPreserveHost On
    ProxyPass / http://172.22.208.47:3003/
    ProxyPassReverse / http://172.22.208.47:3003/

    # WebSocket support (si Next.js lo usa en desarrollo)
    ProxyPass /ws ws://172.22.208.47:3003/ws
    ProxyPassReverse /ws ws://172.22.208.47:3003/ws

    # Headers de seguridad
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"

    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>
</VirtualHost>

# VirtualHost para API Backend (puerto 8080)
<VirtualHost *:8080>
    ServerName 181.114.111.21
    ServerAlias localhost

    # Logs
    ErrorLog "logs/portfolio-api-error.log"
    CustomLog "logs/portfolio-api-access.log" combined

    # Proxy al backend en WSL2
    ProxyPreserveHost On
    ProxyPass / http://172.22.208.47:3002/
    ProxyPassReverse / http://172.22.208.47:3002/

    # CORS Headers (si es necesario)
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"

    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>
</VirtualHost>

# Configuración para HTTPS (cuando se configure SSL)
# <VirtualHost *:443>
#     ServerName 181.114.111.21
#
#     SSLEngine on
#     SSLCertificateFile "conf/ssl/certificate.crt"
#     SSLCertificateKeyFile "conf/ssl/private.key"
#
#     ProxyPreserveHost On
#     ProxyPass / http://172.22.208.47:3003/
#     ProxyPassReverse / http://172.22.208.47:3003/
#
#     <Proxy *>
#         Order deny,allow
#         Allow from all
#     </Proxy>
# </VirtualHost>
